```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EHR Outage Crisis Simulation</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        .header h1 {
            color: #2563eb;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        .card {
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 25px;
            background: #f9fafb;
        }
        .card h2 {
            margin: 0 0 15px 0;
            font-size: 1.5rem;
        }
        .instructor-card {
            border-color: #3b82f6;
            background: #eff6ff;
        }
        .instructor-card h2 {
            color: #1d4ed8;
        }
        .student-card {
            border-color: #10b981;
            background: #ecfdf5;
        }
        .student-card h2 {
            color: #047857;
        }
        .link-box {
            background: white;
            border: 1px solid #d1d5db;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.9rem;
            margin: 10px 0;
            word-break: break-all;
        }
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background: #3b82f6;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            margin: 5px 5px 5px 0;
        }
        .btn:hover {
            background: #2563eb;
        }
        .btn-green {
            background: #10b981;
        }
        .btn-green:hover {
            background: #059669;
        }
        .btn-copy {
            background: #6b7280;
            padding: 5px 10px;
            font-size: 0.8rem;
        }
        .team-item {
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .team-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .instructions {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }
        .instructions h3 {
            color: #92400e;
            margin-top: 0;
        }
        .hidden {
            display: none;
        }
        .status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 15px;
            background: #10b981;
            color: white;
            border-radius: 20px;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <div class="status" id="status">üü¢ Ready</div>
    
    <div class="container">
        <!-- Launcher View -->
        <div id="launcher">
            <div class="header">
                <h1>üè• EHR Outage Crisis Simulation</h1>
                <p style="font-size: 1.2rem; color: #6b7280;">Multi-User Classroom Environment</p>
                <p style="color: #9ca3af;">Healthcare IT Crisis Management Training</p>
            </div>

            <div class="grid">
                <div class="card instructor-card">
                    <h2>‚öôÔ∏è Instructor Access</h2>
                    <p>Dashboard for simulation setup, monitoring, and scoring.</p>
                    
                    <div style="margin: 15px 0;">
                        <strong>Instructor Link:</strong>
                        <div class="link-box" id="instructor-link">Loading...</div>
                        <button class="btn btn-copy" onclick="copyLink('instructor')">üìã Copy Link</button>
                    </div>
                    
                    <button class="btn" onclick="goToInstructor()">üéõÔ∏è Open Instructor Dashboard</button>
                </div>

                <div class="card student-card">
                    <h2>üë• Student Team Links</h2>
                    <p>Direct links for each team role. Share one link per team.</p>
                    
                    <div id="team-links">
                        <!-- Team links will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <div class="instructions">
                <h3>üìã Classroom Setup Instructions</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h4>For Instructors:</h4>
                        <ul>
                            <li>Copy the instructor link above and bookmark it</li>
                            <li>Access the simulation dashboard</li>
                            <li>Configure settings and start the simulation</li>
                            <li>Monitor teams and trigger crisis events</li>
                        </ul>
                    </div>
                    <div>
                        <h4>For Students:</h4>
                        <ul>
                            <li>Each team gets their specific link above</li>
                            <li>Students access their team's dedicated interface</li>
                            <li>Interact with personas and coordinate response</li>
                            <li>Focus on patient safety and team collaboration</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Instructor View -->
        <div id="instructor" class="hidden">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h1 style="color: #1d4ed8;">Instructor Dashboard</h1>
                <button class="btn" onclick="goToLauncher()">‚Üê Back to Launcher</button>
            </div>

            <div class="grid">
                <div class="card">
                    <h2>Simulation Control</h2>
                    <div style="margin: 20px 0;">
                        <label><strong>Duration:</strong></label>
                        <select style="width: 100%; padding: 8px; margin: 5px 0;">
                            <option>2 hours (recommended)</option>
                            <option>90 minutes</option>
                            <option>3 hours</option>
                        </select>
                    </div>
                    <div style="margin: 20px 0;">
                        <label><strong>Difficulty:</strong></label>
                        <select style="width: 100%; padding: 8px; margin: 5px 0;">
                            <option>Medium - Realistic pressure</option>
                            <option>Easy - Guided responses</option>
                            <option>Hard - High stress</option>
                        </select>
                    </div>
                    <button class="btn btn-green" style="width: 100%; padding: 15px;">üöÄ Start Crisis Simulation</button>
                </div>

                <div class="card">
                    <h2>Crisis Triggers</h2>
                    <button class="btn" style="width: 100%; background: #f59e0b; margin: 5px 0;">üö® Trauma Patient Arrival</button>
                    <button class="btn" style="width: 100%; background: #8b5cf6; margin: 5px 0;">üì∫ Media Inquiry</button>
                    <button class="btn" style="width: 100%; background: #ef4444; margin: 5px 0;">üîß Epic Vendor Update</button>
                </div>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h2>Team Overview</h2>
                <div id="team-status">
                    <!-- Team status will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Student View -->
        <div id="student" class="hidden">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <div>
                    <h1 style="color: #dc2626;">‚ö†Ô∏è EHR SYSTEM OUTAGE - ACTIVE</h1>
                    <p style="color: #6b7280; font-size: 1.1rem;">Team: <span id="current-team">Loading...</span></p>
                </div>
                <button class="btn" onclick="goToLauncher()">‚Üê Exit Simulation</button>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                <div style="background: #fef2f2; border-left: 4px solid #dc2626; padding: 15px;">
                    <div style="font-weight: bold;">üïê Crisis Time</div>
                    <div style="font-size: 1.2rem; font-weight: bold;">07:45 AM</div>
                    <div style="font-size: 0.9rem; color: #6b7280;">Outage: 15 minutes</div>
                </div>
                <div style="background: #fff7ed; border-left: 4px solid #f97316; padding: 15px;">
                    <div style="font-weight: bold;">üë• Status</div>
                    <div style="font-weight: bold; color: #dc2626;">CRITICAL</div>
                </div>
                <div style="background: #eff6ff; border-left: 4px solid #3b82f6; padding: 15px;">
                    <div style="font-weight: bold;">üéØ Your Role</div>
                    <div style="font-size: 0.9rem;" id="team-role">Loading...</div>
                </div>
            </div>

            <div class="card" style="background: #fef3c7;">
                <h3>üéØ Your Team Objectives:</h3>
                <ul id="team-objectives">
                    <!-- Objectives will be populated by JavaScript -->
                </ul>
            </div>

            <div class="grid" style="margin-top: 20px;">
                <div class="card">
                    <h3>Available Personas</h3>
                    <div id="persona-list">
                        <!-- Personas will be populated by JavaScript -->
                    </div>
                </div>

                <div class="card">
                    <h3>Crisis Communication</h3>
                    <div style="border: 1px solid #d1d5db; height: 200px; padding: 10px; background: #f9fafb; overflow-y: auto;" id="chat-area">
                        <div style="text-align: center; color: #6b7280; margin-top: 80px;">
                            Select a persona and start gathering information about the crisis...
                            <div style="margin-top: 10px; font-size: 0.9rem;">
                                üí° Try asking: "What's your current situation?"
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 10px; display: flex; gap: 10px;">
                        <input type="text" id="message-input" placeholder="Select a persona first..." style="flex: 1; padding: 8px; border: 1px solid #d1d5db; border-radius: 5px;" disabled>
                        <button class="btn" onclick="sendMessage()" disabled id="send-btn">Send</button>
                    </div>
                    <div id="persona-info" style="margin-top: 10px; padding: 10px; background: #fef3c7; border-left: 4px solid #f59e0b; font-size: 0.9rem; display: none;"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Team and persona data
        const teamRoles = {
            'it_ops': {
                name: 'IT Operations Command',
                description: 'Overall incident response coordination and technical leadership',
                objectives: ['Restore Epic system', 'Coordinate incident response', 'Manage technical resources']
            },
            'clinical_informatics': {
                name: 'Clinical Informatics',
                description: 'Clinical workflow and safety protocols during downtime',
                objectives: ['Ensure patient safety', 'Coordinate downtime procedures', 'Manage clinical workflows']
            },
            'help_desk': {
                name: 'Help Desk & Support',
                description: 'End-user support and communication coordination',
                objectives: ['Support clinical staff', 'Manage user communications', 'Document issues']
            },
            'executive': {
                name: 'Executive Leadership',
                description: 'Strategic decisions and external communication',
                objectives: ['Manage stakeholder communication', 'Make strategic decisions', 'Handle media/regulatory']
            },
            'clinical_depts': {
                name: 'Clinical Departments',
                description: 'Represent ICU, ED, Surgery, and Pharmacy needs',
                objectives: ['Advocate for department needs', 'Implement workarounds', 'Maintain patient care']
            },
            'infrastructure': {
                name: 'Network & Infrastructure',
                description: 'Technical troubleshooting and system recovery',
                objectives: ['Diagnose technical issues', 'Implement recovery procedures', 'Coordinate with vendors']
            }
        };

        const personas = {
            'dr_chen_icu': {
                name: 'Dr. Sarah Chen - ICU Director',
                role: 'Critical Care Physician',
                description: 'Managing 24 ICU patients, frustrated about medication orders',
                stress_level: 'High',
                priorities: ['Patient safety', 'Medication administration', 'Ventilator management']
            },
            'nurse_williams': {
                name: 'Nurse Manager Williams - ED',
                role: 'Emergency Department Nurse Manager',
                description: 'Coordinating 15 nurses during busy morning shift',
                stress_level: 'Very High',
                priorities: ['Patient flow', 'Documentation', 'Staff coordination']
            },
            'ceo_martinez': {
                name: 'CEO Martinez',
                role: 'Hospital Chief Executive Officer',
                description: 'Concerned about reputation, costs, and regulatory compliance',
                stress_level: 'Medium',
                priorities: ['Public relations', 'Financial impact', 'Board communication']
            },
            'cio_johnson': {
                name: 'David Johnson - CIO',
                role: 'Chief Information Officer',
                description: 'Leading incident response, managing IT team, fielding calls from all departments',
                stress_level: 'Very High',
                priorities: ['System restoration', 'Incident command', 'Stakeholder communication']
            }
        };

        // Global variables
        let currentView = 'launcher';
        let currentTeam = '';
        let selectedPersona = '';
        let messages = [];

        // Initialize the page
        function init() {
            const urlParams = new URLSearchParams(window.location.search);
            const mode = urlParams.get('mode');
            const team = urlParams.get('team');

            if (mode === 'instructor') {
                goToInstructor();
            } else if (mode === 'student' && team && teamRoles[team]) {
                currentTeam = team;
                goToStudent();
            } else {
                generateLinks();
                populateTeamLinks();
            }
        }

        // Generate shareable links
        function generateLinks() {
            const baseUrl = window.location.origin + window.location.pathname;
            const instructorLink = baseUrl + '?mode=instructor';
            document.getElementById('instructor-link').textContent = instructorLink;
        }

        // Populate team links
        function populateTeamLinks() {
            const baseUrl = window.location.origin + window.location.pathname;
            const container = document.getElementById('team-links');
            
            Object.entries(teamRoles).forEach(([id, role]) => {
                const teamLink = baseUrl + '?mode=student&team=' + id;
                const div = document.createElement('div');
                div.className = 'team-item';
                div.innerHTML = `
                    <div class="team-name">${role.name}</div>
                    <div style="font-size: 0.9rem; color: #6b7280; margin-bottom: 10px;">${role.description}</div>
                    <div class="link-box" style="font-size: 0.8rem;">${teamLink}</div>
                    <button class="btn btn-copy" onclick="copyTeamLink('${teamLink}')">üìã Copy</button>
                    <button class="btn btn-green" onclick="testTeam('${id}')">Test ${role.name}</button>
                `;
                container.appendChild(div);
            });
        }

        // Navigation functions
        function goToLauncher() {
            document.getElementById('launcher').classList.remove('hidden');
            document.getElementById('instructor').classList.add('hidden');
            document.getElementById('student').classList.add('hidden');
            currentView = 'launcher';
            document.getElementById('status').textContent = 'üü¢ Ready';
        }

        function goToInstructor() {
            document.getElementById('launcher').classList.add('hidden');
            document.getElementById('instructor').classList.remove('hidden');
            document.getElementById('student').classList.add('hidden');
            currentView = 'instructor';
            document.getElementById('status').textContent = 'üë®‚Äçüè´ Instructor';
            populateTeamStatus();
        }

        function goToStudent() {
            document.getElementById('launcher').classList.add('hidden');
            document.getElementById('instructor').classList.add('hidden');
            document.getElementById('student').classList.remove('hidden');
            currentView = 'student';
            document.getElementById('status').textContent = 'üë©‚Äçüéì Student';
            setupStudentView();
        }

        function testTeam(teamId) {
            currentTeam = teamId;
            goToStudent();
        }

        // Copy functions
        function copyLink(type) {
            const link = document.getElementById('instructor-link').textContent;
            navigator.clipboard.writeText(link).then(() => {
                alert('Instructor link copied to clipboard!');
            });
        }

        function copyTeamLink(link) {
            navigator.clipboard.writeText(link).then(() => {
                alert('Team link copied to clipboard!');
            });
        }

        // Setup student view
        function setupStudentView() {
            const team = teamRoles[currentTeam];
            if (!team) return;

            document.getElementById('current-team').textContent = team.name;
            document.getElementById('team-role').textContent = team.name;
            
            const objectivesList = document.getElementById('team-objectives');
            objectivesList.innerHTML = '';
            team.objectives.forEach(objective => {
                const li = document.createElement('li');
                li.textContent = objective;
                objectivesList.appendChild(li);
            });

            populatePersonas();
        }

        // Populate personas
        function populatePersonas() {
            const container = document.getElementById('persona-list');
            container.innerHTML = '';
            
            Object.entries(personas).forEach(([id, persona]) => {
                const div = document.createElement('div');
                div.className = 'team-item';
                div.style.cursor = 'pointer';
                div.onclick = () => selectPersona(id);
                
                const stressColor = persona.stress_level === 'Very High' ? '#dc2626' : 
                                   persona.stress_level === 'High' ? '#f97316' : '#eab308';
                
                div.innerHTML = `
                    <div style="font-weight: bold;">${persona.name}</div>
                    <div style="font-size: 0.9rem; color: #6b7280;">${persona.role}</div>
                    <div style="font-size: 0.8rem; margin-top: 5px;">
                        Stress: <span style="color: ${stressColor}; font-weight: bold;">${persona.stress_level}</span>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // Persona selection
        function selectPersona(personaId) {
            selectedPersona = personaId;
            const persona = personas[personaId];
            
            // Update UI
            document.getElementById('message-input').disabled = false;
            document.getElementById('message-input').placeholder = `Message ${persona.name}...`;
            document.getElementById('send-btn').disabled = false;
            
            // Show persona info
            const infoDiv = document.getElementById('persona-info');
            infoDiv.style.display = 'block';
            infoDiv.innerHTML = `
                <strong>Currently talking to:</strong> ${persona.name}<br>
                <strong>Their situation:</strong> ${persona.description}<br>
                <strong>Key concerns:</strong> ${persona.priorities.join(', ')}
            `;
            
            // Highlight selected persona
            const personaItems = document.querySelectorAll('#persona-list .team-item');
            personaItems.forEach(item => {
                item.style.background = 'white';
                item.style.borderColor = '#d1d5db';
            });
            personaItems[Object.keys(personas).indexOf(personaId)].style.background = '#eff6ff';
            personaItems[Object.keys(personas).indexOf(personaId)].style.borderColor = '#3b82f6';
        }

        // Send message
        function sendMessage() {
            const input = document.getElementById('message-input');
            const message = input.value.trim();
            if (!message || !selectedPersona) return;

            // Add user message
            addMessage('student', message);
            input.value = '';

            // Simulate AI response
            setTimeout(() => {
                const persona = personas[selectedPersona];
                const response = `[${persona.name}] Thank you for reaching out. Given the current EHR outage, my immediate concern is ${persona.priorities[0]}. What specific actions are you taking to address this crisis?`;
                addMessage('persona', response);
            }, 1500);
        }

        // Add message to chat
        function addMessage(sender, content) {
            const chatArea = document.getElementById('chat-area');
            const messageDiv = document.createElement('div');
            messageDiv.style.marginBottom = '10px';
            
            const time = new Date().toLocaleTimeString();
            
            if (sender === 'student') {
                messageDiv.innerHTML = `
                    <div style="text-align: right;">
                        <div style="display: inline-block; background: #3b82f6; color: white; padding: 8px 12px; border-radius: 8px; max-width: 70%;">
                            ${content}
                        </div>
                        <div style="font-size: 0.7rem; color: #6b7280; margin-top: 2px;">${time}</div>
                    </div>
                `;
            } else {
                const persona = personas[selectedPersona];
                messageDiv.innerHTML = `
                    <div style="text-align: left;">
                        <div style="display: inline-block; background: white; border: 1px solid #d1d5db; padding: 8px 12px; border-radius: 8px; max-width: 70%;">
                            <div style="font-size: 0.7rem; color: #6b7280; margin-bottom: 2px;">${persona.name}</div>
                            ${content}
                        </div>
                        <div style="font-size: 0.7rem; color: #6b7280; margin-top: 2px;">${time}</div>
                    </div>
                `;
            }
            
            chatArea.appendChild(messageDiv);
            chatArea.scrollTop = chatArea.scrollHeight;
            
            // Clear welcome message
            if (messages.length === 0) {
                chatArea.innerHTML = '';
            }
            messages.push({sender, content, time});
        }

        // Populate team status for instructor
        function populateTeamStatus() {
            const container = document.getElementById('team-status');
            container.innerHTML = '';
            
            Object.entries(teamRoles).forEach(([id, role]) => {
                const div = document.createElement('div');
                div.className = 'team-item';
                div.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: bold;">${role.name}</div>
                            <div style="font-size: 0.9rem; color: #6b7280;">${role.description}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="display: flex; align-items: center; gap: 5px;">
                                <div style="width: 8px; height: 8px; background: #6b7280; border-radius: 50%;"></div>
                                <span style="font-size: 0.9rem; color: #6b7280;">Offline</span>
                            </div>
                        </div>
                    </div>
                    <div style="font-size: 0.8rem; color: #6b7280; margin-top: 5px;">
                        Score: 0/100 | Messages: 0 | Grade: F
                    </div>
                `;
                container.appendChild(div);
            });
        }

        // Handle Enter key in message input
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('message-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        });

        // Initialize when page loads
        window.onload = init;
    </script>
</body>
</html>
```
